# 一、概述

SDK项目根目录有十个文件，文件对应的简要功能如下表所示：

| 文件名 |  | 功能说明 |
| --- | --- | --- |
| udfs |  | UDFS模块，涵盖UDFS的一些配置和操作接口 |
| config |  | 项目配置文件 |
| daemonCLI |  | 命令行文件 |
| errcode |  | 错误码文件 |
| manage |  | 数据库管理文件 |
| up |  | ulord平台相关http接口封装 |
| user |  | 用户角色分类，包括初级开发者以及中级开发者 |
| utils |  | 工具文件 |
| version |  | 版本文件 |
| webServer |  | web服务文件 |

SDK根据用户的角色提供不同的接口功能。用户角色包含初级开发者角色与中级开发者角色两类。中级开发者仅对UDFS与UP进行了封装和继承。提供一些数据上链的必要操作接口。初级开发者SDK为其设计了默认数据库，根据数据库提供了一些更丰富的操作接口，中级开发者也可以通过模仿设计自己的数据库形式。下文分别列出中级开发者和初级开发者接口调用说明。

# 二、中级开发者接口

其中9-26为封装平台层接口，用户可以访问[https://github.com/UlordChain/Ulord-platform/blob/master/ulord/API.md](https://github.com/UlordChain/Ulord-platform/blob/master/ulord/API.md)查询对应请求参数类型。

## 1、初始化

根据appkey与secret初始化中级开发者角色。appkey与secret均可以通过在平台层注册登录创建应用程序获得。每个应用程序可以获得一对appkey与secret。

## 2、解密

输入：加密信息或加密信息数组

输出：解密信息或解密信息数组

方法名：decrypt

利用公私钥对参数进行解密。参数为被公钥加密过的形式。可以是加密信息数组或单个加密信息。采用RSA加密。加密完需要使用base64进行编码。解密过程为将参数进行base64解码，然后使用私钥进行解密。如果参数为不可解密信息，则返回None。

## 3、配置编辑

输入：需要修改的数组或字典

输出：传入的参数在配置中的形式显示

方法名：config\_edit

根据输入修改配置，如果为数组则转化成字典，配置为一个字典，实现方式为配置字典与参数字典合并。

## 4、配置展示

输入：展示的关键字（默认为空），参数类型为数组或字典。

输出：传入的参数在配置中的形式显示

方法名：config\_show

根据输入展示配置，如果为数组则转化成字典，配置为一个字典，实现方式为配置字典与参数字典合并。

## 5、UDFS下载

输入：udfs哈希列表

输出：对应的哈希字典，下载成功为true，失败为false

方法名：udfs\_download

根据输入去下载对应的资源，讲结果组成字典返回。

## 6、UDFS上传

输入：需要上传的文件名或者文件流或者对应的列表

输出：上传结果，对应文件名、文件流或者列表字典，上传成功为true，失败为false

方法名：udfs\_upload

根据输入讲内容上传至UDFS中，判断参数类型去调用对应的内置方法实现上传。

## 7、UDFS内容查看

输入：需要查看的udfs哈希值列表

输出：对应哈希值内容字典。成功为内容字符串，失败为0

方法名：udfs\_cat

根据输入遍历哈希值在UDFS上查阅对应的内容，已字符串形式返回。

## 8、自定义请求

输入：请求方法,请求url,请求参数字典

输出：请求结果

方法名：request

根据输入向平台层请求。此方法考虑到平台层向后兼容，用户可自己添加SDK未提供而平台层提供的接口。

## 9、生成钱包

输入：用户名，密码

输出：平台层json结果

方法名：regist

根据输入创建一个托管ulord钱包。

## 10、资源发布

输入：发布数据字典

输出：平台层json结果

方法名：publish

将字典内容上链，发布到ulord链上。

## 11、资源更新

输入：更新数据字典

输出：平台层json结果

方法名：update

根据输入更新ulord链上数据

## 12、资源删除

输入：平台层数据ID，钱包密码

输出：平台层json结果

方法名：delete

根据输入删除ulord链上数据

## 13、资源付费

输入：支付者钱包名，资源链上ID(claim\_id)，钱包密码，资源是否为广告（默认不是）

输出：平台层json结果

方法名：transaction

根据输入对资源进行消费。如果为广告则需要传入作者的钱包密码。

## 14、向用户转账

输入：需要修改的数组或字典

输出：平台层json结果

方法名：paytouser

根据输入修改配置，如果为数组则转化成字典，配置为一个字典，实现方式为配置字典与参数字典合并。

## 15、资源列表

输入：第几页(默认为第一页)，每页几条数据（默认十条）

输出：平台层json结果

方法名：queryresource

根据输入返回资源列表。

## 16、余额查询

输入：钱包名，钱包密码

输出：平台层json结果

方法名：querybalance

根据输入查询余额。

## 17、资源是否已购买

输入：钱包名，资源链上ID（claim\_id）列表

输出：平台层json结果

方法名：queryisbought

根据输入查询资源是否已经购买。

## 18、查询用户已发布资源

输入：钱包名，第几页（默认为第一页），每页多少条数据（默认十条）

输出：平台层json结果

方法名：queryuserpublished

根据输入查询用户已发布的资源列表。

## 19、根据ID查询资源详情

输入：资源在平台层中的ID列表

输出：平台层json结果

方法名：query\_resource\_by\_ID

根据输入查询资源的详细情况。

## 20、根据ID查询交易详情

输入：资源在链上的ID（claim\_id）

输出：平台层json结果

方法名：queryBillingDetailByID

根据输入查询资源的交易情况。

## 21、根据ID查询单资源消费情况

输入：资源在链上的ID（claim\_id）列表

输出：平台层json结果

方法名：queryStatisticsByID

根据输入查询资源的消费情况。

## 22、查询收入账单

输入：作者钱包名，开始时间，结束时间，第几页（默认第一页），每页显示多少条数据（默认10条）,收入类型（默认为2）

输出：平台层json结果

方法名：queryincomebillings

根据输入查询这段时间收入账单，收入类型为0，1，2。对应类型为普通资源，广告，以及所有。

## 23、查询支出账单

输入：作者钱包名，开始时间，结束时间，第几页（默认第一页），每页显示多少条数据（默认10条）,收入类型（默认为2）

输出：平台层json结果

方法名：queryoutgobillings

根据输入查询这段时间支出账单，收入类型为0，1，2。对应类型为普通资源，广告，以及所有。

## 24、查询收支账单详情

输入：作者钱包名，第几页（默认第一页），每页显示多少条数据（默认10条）

输出：平台层json结果

方法名：querybillingsdetail

根据输入查询收支账单详情。

## 25、查询收支账单概览

输入：作者钱包名，开始时间，结束时间

输出：平台层json结果

方法名：querybillings

根据输入查询这段时间内的收支账单概览。

## 26、已发布资源总数

输入：作者钱包名，开始时间，结束时间

输出：平台层json结果

方法名：querypublishnum

根据输入查询这段时间内的已发布的资源总数。

# 三、初级开发者接口

初级开发者接口继承与中级开发者接口，故中级开发者的所有接口初级开发者均可使用。初级开发者与中级开发者的主要区别在于为初级开发者提供了一些基本的数据库结构存储，一些接口调用直接使用内置的数据库去调用，是开发者可以快速开发简单应用，如果需要更复杂的数据结构则需要使用中级开发者创建自己的数据库，或者直接修改SDK的内容丰富自己的数据库结构。

加密部分采用RSA加密，公私钥自动生成，也可以第三方生成在配置文件中指定到对应的公私钥文件地址。

## 27、用户注册

输入：用户名，密码，手机号（默认为空），邮箱（默认为空），钱包名（默认和用户名相同），钱包密码（默认和密码相同），密码是否加密（默认不加密）

输出：成功返回用户有效登录的token。错误则返回平台层创建钱包错误。

方法名：user\_regist

根据输入注册新用户。

## 28、用户登录

输入：用户名，密码，密码是否加密（默认不加密）

输出：成功返回用户有效登录的token。错误则返回对应的错误码。

方法名：user\_login

根据输入登录。

## 29、用户登出

输入：token（默认为none），username（默认为none）（token与username需要填写一个即可。）

输出：成功则返回用户名，错误则返回对应的错误码。

方法名：user\_logout

根据输入查询这段时间内的已发布的资源总数。

## 30、优惠活动

输入：token（默认为none），username（默认为none）（token与username需要填写一个即可。）

输出：成功则返回优惠赠送的ulord数量，错误则返回对应的错误码。

方法名：user\_activity

根据输入给用户赠送一定数量的ulord。由开发者账户赠送，数量可以在配置文件中修改，默认为10个。

## 31、资源发布

输入：资源标题，资源的udfs哈希值，定价价格，资源标签列表，资源描述，用户条件。(用户条件为一个字典，key值可以为userid，username或usertoken，根据其中之一在本地数据库查找对应用户)

输出：平台层资源发布json结果

方法名：resource\_publish

根据输入发布资源，将资源上链。

## 32、资源更新

输入：资源在平台层中的ID，用户钱包密码，密码是否加密（默认加密），标题（默认为空），内容（默认为空），价格（默认为空），标签列表（默认为空），资源描述（默认为空）。根据后面的参数更新资源的对应值。为空则不更新该字段。

输出：平台层更新资源的json结果

方法名：resource\_update

根据输入更新对应资源。根据传入的参数更新对应的字段。

## 33、添加资源访问量

输入：资源标题

输出：资源的访问量

方法名：resource\_views

根据输入向资源的访问量增加1。

## 34、支付资源

输入：用户类，资源在链上的ID（claim\_id），用户密码(不是钱包密码)， 密码是否加密（默认不加密）

输出：平台层支付接口json结果

方法名：pay\_resource

根据输入支付资源以获取资源的udfs哈希值。

## 35、支付广告

输入：用户钱包名，资源在链上的ID，作者名

输出：平台层支付接口json结果

方法名：pay\_ads

根据输入支付广告，作者对用户进行支付。

## 36、用户信息查询

输入：用户名（默认为none），token（默认为none）参数填写二者之一即可。

输出：成功则返回用户用户名、手机、邮箱，失败则返回对应的错误码。

方法名：user\_info\_query

根据输入查询用户信息。注意，数据库中密码为密文存储，故不可知密码。所以无法返回。

## 37、用户信息修改

输入：用户名（默认为空），token（默认为空），密码是否加密（默认不加密,对新旧密码均加密），用户密码（默认为空），手机号（默认为空），邮箱（默认为空）,新密码（默认为空）

输出：成功则修改后的用户名、手机、邮箱，失败则返回对应的错误码。

方法名：user\_infor\_modify

根据输入中的用户名或者token（二者传一个即可）查询出对应的用户信息，然后根据传入的参数修改对应值，不传或传空则表示不修改。

## 38、创建数据库

输入：数据库地址(默认为空，地址为角色初始化文件位置)

输出：无

方法名：create\_database

根据输入查询这段时间内的已发布的资源总数。

## 39、开启web

输入：无

输出：无

方法名：start\_web

开启web服务。

## 40、高级查询

输入：sql语句

输出：sql执行结果

方法名：query

根据输入对数据库执行操作。

